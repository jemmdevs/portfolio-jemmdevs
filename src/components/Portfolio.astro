---
import { getCollection } from 'astro:content';

// Get the first entry from the portfolio collection
const portfolioEntries = await getCollection('portfolio');
const portfolioEntry = portfolioEntries[0]; // Get the first entry
const { name, title, github } = portfolioEntry.data;
const { Content } = await portfolioEntry.render();
---

<div class="page-container">
  <div class="parallax-stars"></div>
  <button id="mobile-menu-toggle" class="mobile-menu-toggle">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </button>
  <div class="side-buttons">
    <a href="https://jemmdevs.vercel.app/" target="_blank" rel="noopener noreferrer" class="side-button">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
        <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
      </svg>
      <span>My Blog</span>
    </a>
    <button class="side-button" disabled>
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <polygon points="12 2 19 21 12 17 5 21 12 2"></polygon>
      </svg>
      <span>Projects</span>
    </button>
    <button class="side-button" id="contact-button">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
        <polyline points="22,6 12,13 2,6"></polyline>
      </svg>
      <span>Contact Me</span>
    </button>
    <button id="download-pdf" class="side-button">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
        <polyline points="7 10 12 15 17 10"></polyline>
        <line x1="12" y1="15" x2="12" y2="3"></line>
      </svg>
      <span>Download CV</span>
    </button>
  </div>

  <div class="outer-container">
    <div class="quote-container">
      <blockquote id="quote-text" class="quote"></blockquote>
      <p id="quote-author" class="quote-author"></p>
    </div>
    
    <div class="portfolio-container">
      <div class="portfolio-content">
        <Content />
      </div>
    </div>
  </div>

  <!-- Modal para contacto -->
  <div id="contact-modal" class="contact-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Contact Me</h2>
        <button id="close-modal">&times;</button>
      </div>
      <form id="contact-form">
        <div class="form-group">
          <label for="name">Name</label>
          <input type="text" id="name" name="name" required>
        </div>
        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" name="email" required>
        </div>
        <div class="form-group">
          <label for="message">Message</label>
          <textarea id="message" name="message" rows="5" required></textarea>
        </div>
        <button type="submit" class="submit-button">Send Message</button>
      </form>
      <div id="form-status" class="form-status"></div>
    </div>
  </div>
</div>

<style>
  .page-container {
    display: flex;
    width: 100%;
    min-height: 100vh;
    align-items: flex-start;
    justify-content: center;
  }

  .side-buttons {
    display: flex;
    flex-direction: column;
    position: fixed;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    gap: 1rem;
    padding: 1rem;
    z-index: 10;
  }

  .mobile-menu-toggle {
    display: none;
    position: fixed;
    top: 1rem;
    left: 1rem;
    z-index: 100;
    background-color: transparent;
    border: 1px solid var(--border-color);
    border-radius: 50%;
    width: 48px;
    height: 48px;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
    padding: 0;
    transition: transform 0.3s ease;
    color: var(--text-color);
  }
  
  .mobile-menu-toggle svg {
    stroke: var(--text-color);
  }
  
  .mobile-menu-toggle:hover {
    transform: scale(1.05);
  }
  
  .mobile-menu-toggle.active {
    color: var(--accent-color);
  }
  
  .dark .mobile-menu-toggle svg {
    stroke: #fff;
  }
  
  .light .mobile-menu-toggle svg {
    stroke: #000;
  }
  
  .theme-toggle {
    position: fixed;
    top: 1rem;
    right: 1rem;
    z-index: 100;
    background-color: transparent;
    border: 1px solid var(--border-color);
    border-radius: 50%;
    width: 48px;
    height: 48px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .theme-toggle:hover {
    transform: scale(1.05);
  }

  .side-button {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.7rem 1rem;
    background-color: transparent;
    border: 1px solid var(--border-color);
    color: var(--text-color);
    border-radius: 0 4px 4px 0;
    cursor: pointer;
    font-family: 'Courier New', Courier, monospace;
    font-size: 0.85rem;
    transition: all 0.2s ease;
    text-decoration: none;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
    min-width: 120px;
  }

  .side-button:hover {
    transform: translateX(5px);
    box-shadow: 3px 3px 7px rgba(0, 0, 0, 0.15);
  }

  .side-button[disabled] {
    cursor: not-allowed;
    opacity: 0.7;
  }

  .side-button[disabled]:hover {
    transform: none;
    box-shadow: 2px 2px 5px rgba(0, 0, 0, 0.1);
  }

  .outer-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 860px;
    margin: 0 auto;
    padding: 0 1rem;
  }

  .portfolio-container {
    width: 100%;
    max-width: 640px;
    margin: 0 auto;
    padding: 1.2rem 1.8rem;
    font-family: 'Courier New', Courier, monospace;
    line-height: 1.3;
    background-color: var(--bg-paper);
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border: 1px solid rgba(0, 0, 0, 0.1);
    border-radius: 0;
    font-size: 0.9rem;
    color: var(--text-color);
    box-sizing: border-box;
  }

  .portfolio-content {
    margin-bottom: 1.2rem;
    font-weight: 300;
  }

  /* Modal de contacto */
  .contact-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    background-color: var(--bg-paper);
    padding: 1.5rem;
    border-radius: 5px;
    width: 95%;
    max-width: 450px;
    color: var(--text-color);
    font-family: 'Courier New', Courier, monospace;
  }

  .modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
  }

  .modal-header h2 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 600;
    border-bottom: none;
  }

  #close-modal {
    background: none;
    border: none;
    font-size: 1.5rem;
    cursor: pointer;
    color: var(--text-color);
  }

  .form-group {
    margin-bottom: 1rem;
  }

  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
  }

  .form-group input,
  .form-group textarea {
    width: 100%;
    padding: 0.5rem;
    font-family: 'Courier New', Courier, monospace;
    font-size: 0.9rem;
    border: 1px solid var(--border-color);
    background-color: var(--bg-paper);
    color: var(--text-color);
    border-radius: 3px;
  }

  .submit-button {
    background-color: transparent;
    border: 1px solid var(--text-color);
    color: var(--text-color);
    padding: 0.5rem 1rem;
    cursor: pointer;
    font-family: 'Courier New', Courier, monospace;
    font-size: 0.9rem;
    border-radius: 3px;
    margin-top: 0.5rem;
    transition: all 0.2s ease;
  }

  .submit-button:hover {
    background-color: rgba(128, 128, 128, 0.1);
  }

  .form-status {
    margin-top: 1rem;
    font-size: 0.9rem;
    text-align: center;
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateY(10px);
    height: 0;
    overflow: hidden;
    border-radius: 4px;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
  }

  .form-status.active {
    opacity: 1;
    transform: translateY(0);
    height: auto;
    padding: 1rem;
    margin-top: 1.2rem;
    pointer-events: auto;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  .success-message {
    background-color: rgba(76, 175, 80, 0.08);
    color: var(--accent-color);
    border: 1px solid rgba(76, 175, 80, 0.3);
    border-radius: 4px;
  }

  .error-message {
    background-color: rgba(244, 67, 54, 0.08);
    color: #f44336;
    border: 1px solid rgba(244, 67, 54, 0.3);
    border-radius: 4px;
  }

  .status-icon {
    display: inline-flex;
    margin-right: 0.8rem;
    align-items: center;
    justify-content: center;
  }

  .status-icon svg {
    stroke-width: 2;
    width: 24px;
    height: 24px;
  }

  .success-message .status-icon svg {
    stroke: var(--accent-color);
  }

  .error-message .status-icon svg {
    stroke: #f44336;
  }

  :global(.profile-header) {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1.2rem;
    flex-wrap: wrap;
    gap: 1rem;
    border-bottom: 1px solid currentColor;
    padding-bottom: 0.8rem;
  }

  :global(.profile-info) {
    flex: 1;
    min-width: 200px;
  }

  :global(.profile-info h1) {
    margin: 0;
    font-size: 1.8rem;
    border-bottom: none;
    padding-bottom: 0;
    font-weight: 600;
  }

  :global(.profile-info h2) {
    margin: 0.2rem 0 0 0;
    font-size: 1.1rem;
    font-weight: normal;
    border-bottom: none;
    padding-bottom: 0;
    opacity: 0.8;
  }

  :global(.contact-label) {
    margin: 0.8rem 0 0.2rem;
    font-size: 0.85rem;
    opacity: 0.7;
    font-weight: 600;
  }

  :global(.github-link) {
    display: inline-flex;
    text-decoration: none;
    color: var(--text-color);
    opacity: 0.8;
    transition: opacity 0.2s ease;
  }

  :global(.github-link:hover) {
    opacity: 1;
  }

  :global(.github-icon) {
    transition: transform 0.2s ease;
  }

  :global(.github-link:hover .github-icon) {
    transform: scale(1.1);
  }

  :global(.profile-image) {
    flex-shrink: 0;
  }

  :global(.profile-image img) {
    width: 90px;
    height: 90px;
    object-fit: cover;
    border-radius: 50%;
    border: 1px solid currentColor;
  }

  :global(h1, h2, h3) {
    font-weight: 600;
    border-bottom: 1px solid currentColor;
    padding-bottom: 0.2rem;
    margin-top: 1.1rem;
    margin-bottom: 0.7rem;
  }

  :global(h1) {
    font-size: 1.8rem;
  }

  :global(h2) {
    font-size: 1.3rem;
    margin-top: 1.1rem;
  }

  :global(h3) {
    font-size: 1rem;
    margin-top: 0.9rem;
    opacity: 0.9;
  }

  :global(ul) {
    list-style-type: square;
    padding-left: 1.4rem;
    margin: 0.7rem 0;
    opacity: 0.9;
  }

  :global(li) {
    margin-bottom: 0.25rem;
  }

  :global(p) {
    margin: 0.7rem 0;
    opacity: 0.9;
  }

  :global(strong) {
    font-weight: 600;
  }

  :global(a) {
    color: inherit;
    text-decoration: underline;
  }

  @media (max-width: 768px) {
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    
    .page-container {
      flex-direction: column;
      padding-top: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
    }

    .outer-container {
      width: 100%;
      max-width: 520px;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin: 0 auto;
    }

    .mobile-menu-toggle {
      display: flex;
    }

    .side-buttons {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: auto;
      transform: none;
      flex-direction: column;
      background-color: var(--bg-paper);
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
      border-bottom: 1px solid var(--border-color);
      padding: 4rem 1rem 1rem;
      z-index: 90;
      transform: translateY(-100%);
      transition: transform 0.3s ease;
    }
    
    .side-buttons.active {
      transform: translateY(0);
    }
    
    .theme-toggle {
      position: fixed !important;
      top: 1rem !important;
      right: 1rem !important;
      z-index: 150 !important;
    }
    
    .side-button {
      border-radius: 4px;
      min-width: auto;
      width: 100%;
    }
    
    .side-button:hover {
      transform: translateY(-3px);
    }

    .portfolio-container {
      padding: 0.8rem 1.2rem;
      margin: 0.5rem auto;
      width: 100%;
      max-width: 520px;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      border: 1px solid var(--border-color);
      font-size: 0.85rem;
      box-sizing: border-box;
    }
    
    .quote-container {
      padding: 0.6rem 1rem;
      margin: 0 auto 1rem auto;
      max-width: 520px;
      width: 100%;
      box-sizing: border-box;
    }

    :global(h1) {
      font-size: 1.5rem;
    }
    
    :global(h2) {
      font-size: 1.1rem;
    }

    :global(.profile-header) {
      flex-direction: column-reverse;
      align-items: center;
      text-align: center;
    }

    :global(.profile-image img) {
      width: 80px;
      height: 80px;
    }

    :global(.profile-info) {
      width: 100%;
      text-align: center;
    }

    :global(.github-link) {
      justify-content: center;
    }

    .quote {
      font-size: 0.8rem;
    }

    .quote-author {
      font-size: 0.7rem;
    }
  }

  :global(section) {
    break-inside: avoid;
    page-break-inside: avoid;
    margin-bottom: 0.8rem;
  }

  :global(.approach-section) {
    break-inside: avoid;
    page-break-inside: avoid;
  }

  :global(.prevent-break) {
    break-after: avoid;
    page-break-after: avoid;
  }

  :global(h2 + p), :global(h2 + ul), :global(h3 + p), :global(h3 + ul) {
    break-before: avoid;
    page-break-before: avoid;
  }

  /* Theme transition animation */
  :root {
    --accent-color: #4a6fa5;
  }

  .dark {
    --accent-color: #6d9feb;
  }

  .theme-transition {
    transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
  }

  .theme-transition * {
    transition: background-color 0.5s ease, color 0.5s ease, border-color 0.5s ease, box-shadow 0.5s ease;
  }

  /* Parallax effect */
  .parallax-stars {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    pointer-events: none;
  }

  .parallax-star {
    position: absolute;
    width: 3px;
    height: 3px;
    border-radius: 50%;
    background-color: var(--accent-color);
    opacity: 0.5;
  }

  /* Programming quotes */
  .quote-container {
    width: 100%;
    max-width: 640px;
    margin: 0 auto 1.5rem;
    text-align: center;
    padding: 0.8rem 1.5rem;
    background-color: var(--bg-paper);
    border-left: 3px solid var(--accent-color);
    border-right: 3px solid var(--accent-color);
    box-shadow: 0 3px 5px var(--shadow-color);
    font-style: italic;
    opacity: 0.9;
    transform: translateY(0);
    transition: transform 0.3s ease;
    box-sizing: border-box;
  }

  .quote-container:hover {
    transform: translateY(-5px);
    opacity: 1;
  }

  .quote {
    font-size: 0.9rem;
    margin: 0 0 0.5rem;
    line-height: 1.4;
    position: relative;
  }

  .quote::before {
    content: '"';
    font-size: 1.5rem;
    margin-right: 0.3rem;
    vertical-align: middle;
    opacity: 0.7;
    color: var(--accent-color);
  }

  .quote::after {
    content: '"';
    font-size: 1.5rem;
    margin-left: 0.3rem;
    vertical-align: middle;
    opacity: 0.7;
    color: var(--accent-color);
  }

  .quote-author {
    font-size: 0.8rem;
    opacity: 0.7;
    text-align: right;
    margin: 0;
  }

  .quote-author::before {
    content: '— ';
  }
</style>

<script>
  // Cargar EmailJS SDK
  const loadEmailJS = () => {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js';
    script.async = true;
    document.body.appendChild(script);

    return new Promise((resolve) => {
      script.onload = () => {
        // @ts-ignore
        if (window.emailjs) {
          // @ts-ignore
          window.emailjs.init('waONZgvG5drpYE06F'); // Public key
          resolve(true);
        }
      };
    });
  };

  document.addEventListener('DOMContentLoaded', async () => {
    // Cargar EmailJS
    await loadEmailJS();

    // Mobile menu functionality
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const sideButtons = document.querySelector('.side-buttons');
    
    if (mobileMenuToggle && sideButtons) {
      mobileMenuToggle.addEventListener('click', () => {
        sideButtons.classList.toggle('active');
        mobileMenuToggle.classList.toggle('active');
      });
      
      // Close menu when clicking outside
      document.addEventListener('click', (e) => {
        const target = e.target as Node;
        if (
          !sideButtons.contains(target) && 
          target !== mobileMenuToggle && 
          !mobileMenuToggle.contains(target) &&
          sideButtons.classList.contains('active')
        ) {
          sideButtons.classList.remove('active');
          mobileMenuToggle.classList.remove('active');
        }
      });
    }

    // Funcionalidad de descarga de CV
    const downloadBtn = document.getElementById('download-pdf');
    if (downloadBtn) {
      downloadBtn.addEventListener('click', () => {
        // Crea una hoja de estilo específica para impresión
        const style = document.createElement('style');
        style.type = 'text/css';
        style.id = 'print-style';
        style.innerHTML = `
          @media print {
            body * {
              visibility: hidden;
            }
            .portfolio-container, .portfolio-container * {
              visibility: visible;
            }
            .portfolio-container {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
              box-shadow: none !important;
              border: none !important;
            }
            @page {
              size: A4;
              margin: 1cm;
            }
          }
        `;
        document.head.appendChild(style);
        
        // Imprimir y luego eliminar el estilo
        window.print();
        
        // Eliminar el estilo después de imprimir
        const printStyle = document.getElementById('print-style');
        if (printStyle) {
          document.head.removeChild(printStyle);
        }
      });
    }

    // Funcionalidad del modal de contacto
    const contactBtn = document.getElementById('contact-button');
    const contactModal = document.getElementById('contact-modal') as HTMLElement;
    const closeModal = document.getElementById('close-modal');
    const contactForm = document.getElementById('contact-form') as HTMLFormElement;
    const formStatus = document.getElementById('form-status') as HTMLElement;

    // Abrir modal
    if (contactBtn && contactModal) {
      contactBtn.addEventListener('click', () => {
        contactModal.style.display = 'flex';
      });
    }

    // Cerrar modal
    if (closeModal && contactModal) {
      closeModal.addEventListener('click', () => {
        contactModal.style.display = 'none';
      });
    }

    // Cerrar modal al hacer clic fuera
    window.addEventListener('click', (e) => {
      if (e.target === contactModal) {
        contactModal.style.display = 'none';
      }
    });

    // Enviar formulario con EmailJS
    if (contactForm && formStatus) {
      contactForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const nameInput = contactForm.querySelector('#name') as HTMLInputElement;
        const emailInput = contactForm.querySelector('#email') as HTMLInputElement;
        const messageInput = contactForm.querySelector('#message') as HTMLTextAreaElement;
        const submitBtn = contactForm.querySelector('.submit-button') as HTMLButtonElement;
        
        if (!nameInput || !emailInput || !messageInput || !submitBtn) {
          console.error('Missing form elements');
          return;
        }
        
        // Guardar texto original del botón
        const originalBtnText = submitBtn.textContent || 'Send Message';
        
        // Actualizar UI para mostrar estado de envío
        formStatus.textContent = '';
        formStatus.classList.remove('error-message', 'success-message', 'active');
        submitBtn.textContent = 'Sending...';
        submitBtn.disabled = true;
        
        try {
          // @ts-ignore
          await window.emailjs.send(
            'service_j5q6azh', // Service ID
            'template_gkt7fwu', // Template ID
            {
              from_name: nameInput.value,
              reply_to: emailInput.value,
              message: messageInput.value
            }
          );
          
          // Crear mensaje de éxito con icono
          const successIcon = document.createElement('span');
          successIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>';
          successIcon.className = 'status-icon';
          
          const messageText = document.createElement('span');
          messageText.textContent = 'Message sent successfully';
          
          formStatus.innerHTML = '';
          formStatus.appendChild(successIcon);
          formStatus.appendChild(messageText);
          formStatus.classList.add('success-message', 'active');
          
          // Efecto de animación en el icono
          const iconSVG = successIcon.querySelector('svg');
          if (iconSVG) {
            iconSVG.style.transform = 'scale(0)';
            iconSVG.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            
            setTimeout(() => {
              iconSVG.style.transform = 'scale(1)';
            }, 10);
          }
          
          // Resetear formulario
          contactForm.reset();
          
          // Cerrar modal después de un tiempo
          setTimeout(() => {
            if (contactModal) {
              // Agregar animación de desvanecimiento al modal
              contactModal.style.opacity = '0';
              contactModal.style.transition = 'opacity 0.5s ease';
              
              setTimeout(() => {
                contactModal.style.display = 'none';
                contactModal.style.opacity = '1';
              }, 500);
            }
            
            // Desactivar el estado del formulario con animación
            formStatus.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
            formStatus.style.opacity = '0';
            formStatus.style.transform = 'translateY(10px)';
            
            setTimeout(() => {
              formStatus.classList.remove('active');
              setTimeout(() => {
                formStatus.innerHTML = '';
                formStatus.classList.remove('success-message');
                formStatus.removeAttribute('style');
              }, 300);
            }, 300);
          }, 2500);
        } catch (error) {
          console.error('Error sending email:', error);
          
          // Crear mensaje de error con icono
          const errorIcon = document.createElement('span');
          errorIcon.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>';
          errorIcon.className = 'status-icon';
          
          const messageText = document.createElement('span');
          messageText.textContent = 'Failed to send message. Please try again.';
          
          formStatus.innerHTML = '';
          formStatus.appendChild(errorIcon);
          formStatus.appendChild(messageText);
          formStatus.classList.add('error-message', 'active');
          
          // Efecto de animación en el icono
          const iconSVG = errorIcon.querySelector('svg');
          if (iconSVG) {
            iconSVG.style.transform = 'scale(0)';
            iconSVG.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
            
            setTimeout(() => {
              iconSVG.style.transform = 'scale(1)';
            }, 10);
          }
        } finally {
          // Restaurar estado del botón
          submitBtn.textContent = originalBtnText;
          submitBtn.disabled = false;
        }
      });
    }

    // Initialize parallax effect
    initParallax();
    
    // Initialize random quote
    initRandomQuote();
  });

  // Programming quotes
  const programmingQuotes = [
    {
      text: "Any fool can write code that a computer can understand. Good programmers write code that humans can understand.",
      author: "Martin Fowler"
    },
    {
      text: "First, solve the problem. Then, write the code.",
      author: "John Johnson"
    },
    {
      text: "Experience is the name everyone gives to their mistakes.",
      author: "Oscar Wilde"
    },
    {
      text: "Programming isn't about what you know; it's about what you can figure out.",
      author: "Chris Pine"
    },
    {
      text: "The most important property of a program is whether it accomplishes the intention of its user.",
      author: "C.A.R. Hoare"
    },
    {
      text: "The best way to predict the future is to implement it.",
      author: "David Heinemeier Hansson"
    },
    {
      text: "Sometimes it pays to stay in bed on Monday, rather than spending the rest of the week debugging Monday's code.",
      author: "Dan Salomon"
    },
    {
      text: "Code is like humor. When you have to explain it, it's bad.",
      author: "Cory House"
    },
    {
      text: "Make it work, make it right, make it fast.",
      author: "Kent Beck"
    },
    {
      text: "Simplicity is the soul of efficiency.",
      author: "Austin Freeman"
    },
    {
      text: "The function of good software is to make the complex appear to be simple.",
      author: "Grady Booch"
    },
    {
      text: "It's not a bug – it's an undocumented feature.",
      author: "Anonymous"
    }
  ];

  // Parallax effect initialization
  function initParallax() {
    const starsContainer = document.querySelector('.parallax-stars');
    
    if (!starsContainer) return;
    
    // Create random stars
    const numStars = 50;
    
    for (let i = 0; i < numStars; i++) {
      const star = document.createElement('div');
      star.className = 'parallax-star';
      
      // Random position
      const x = Math.random() * 100;
      const y = Math.random() * 100;
      star.style.left = `${x}%`;
      star.style.top = `${y}%`;
      
      // Random size
      const size = Math.random() * 3 + 1;
      star.style.width = `${size}px`;
      star.style.height = `${size}px`;
      
      // Random opacity
      star.style.opacity = (Math.random() * 0.5 + 0.1).toString();
      
      // Add to DOM
      starsContainer.appendChild(star);
    }
    
    // Add parallax effect on mouse move
    document.addEventListener('mousemove', (e) => {
      const mouseX = e.clientX / window.innerWidth;
      const mouseY = e.clientY / window.innerHeight;
      
      const stars = document.querySelectorAll('.parallax-star');
      stars.forEach((star, index) => {
        const speed = (index % 10) / 30 + 0.03;
        const offsetX = (mouseX - 0.5) * speed * 100;
        const offsetY = (mouseY - 0.5) * speed * 100;
        
        const starElement = star as HTMLElement;
        starElement.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
      });
    });
  }
  
  // Random quote initialization
  function initRandomQuote() {
    const quoteText = document.getElementById('quote-text');
    const quoteAuthor = document.getElementById('quote-author');
    
    if (!quoteText || !quoteAuthor) return;
    
    // Get a random quote
    const randomIndex = Math.floor(Math.random() * programmingQuotes.length);
    const quote = programmingQuotes[randomIndex];
    
    // Display the quote
    quoteText.textContent = quote.text;
    quoteAuthor.textContent = quote.author;
  }
</script> 